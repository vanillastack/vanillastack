apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: "redis-{{ redis.environment | default('testing') }}"
  namespace: "{{ redis.namespace }}"
  labels:
    app: kube-prometheus-stack
    release: prometheus-operator
spec:
  groups:
  - name: redis
    rules:
      - alert: RedisDown
        expr: 'redis_up{service="redis-{{ redis.environment | default('testing') }}-metrics"} == 0'
        for: 2m
        labels:
          severity: error
        annotations:
{% raw %}
          summary: 'Redis(TM) instance {{ "{{ $instance }}" }} down'
          description: 'Redis(TM) instance {{ "{{ $instance }}" }} is down.'
{% endraw %}
